test:
  track:
    exp_name: &TEST_NAME "mobilenet_l4_fusion48ll"
    exp_save: &TEST_SAVE "logs"

    model:
      task_model:
        name: "MySiamTrack_fusion"
        MySiamTrack_fusion:
          pretrain_model_path: "/home/droneyee/video_analyst/models/epoch-48.pkl"
          amp: &amp False
          in_channels: 192   # 192
          mid_channels: &MID_CHANNELS 192   # 128
      backbone:
        name: "MobileNetV3_div"
        Inception3:
          crop_pad: 4
          pruned: True
          pretrain_model_path: "models/googlenet/inception_v3_google-1a9a5a14-961cad7697695cca7d9ca4814b17a88d.pth"
        MobileNetV3:
          pretrained: 'models/mobilenet/mobilenetv3_small_1.0.pth'
        MobileNetV3_div:
          cfgs_mode: 'small'
          pretrained: 'models/mobilenet/mobilenetv3_small_1.0.pth'
          used_layers: [ 6, 8, 11 ]
          feat_channel: [ 40, 48, 96 ]
          final_channel: &IN_CHANNELS 48
        MobileNetV3_new:
          cfgs_mode: 'small'
          pretrained: 'models/mobilenet/mobilenetv3_small_1.0.pth'
          used_layers: [ 6, 8, 11 ]
          feat_channel: [ 40, 48, 96 ]
          feat_fx_size: [ 19, 19, 10 ]
          feat_fz_size: [ 8, 8, 4 ]
          final_channel: 48
          num_heads: 3
          num_layers: 2
          prob_dropout: 0.0

        MobileNetV3_fusion:
          cfgs_mode: 'small'
          pretrained: 'models/mobilenet/mobilenetv3_small_1.0.pth'
          used_layers: [ 6, 8, 11 ]
          feat_channel: [ 40, 48, 96 ]
          feat_fx_size: [ 19, 19, 10 ]
          feat_fz_size: [ 8, 8, 4 ]
          final_channel: 48
          num_heads: 3
          num_layers: 2
          prob_dropout: 0.0
      fusion:
        name: "Fusion_M"
        FusionX:
          input_channel: 48
          input_channelX: 96
          feat_fx_size: [8, 8, 4]
          feat_fz_size: [19, 19, 10]
          used_layers: [6, 8, 11]
          num_heads: 3
          num_layers: 2
          prob_dropout: 0.1
        Fusion_M:
          input_channel: 48
          feat_fx_size: [ 8, 8, 4 ]
          feat_fz_size: [ 19, 19, 10 ]
          used_layers: [ 6, 8, 11 ]
          num_heads: 3
          num_layers: 4
          prob_dropout: 0.1
      neck:
        name: "Transformer_fusion"
        Transformer_fusion:
          num_encoder_layer: 2
          num_decoder_layer: 2
          d_model: 192
          nhead: 4
          score_size_z: 8
          score_size_x: 19
      losses:
        names: [
                 "FocalLossFC",
                 "IOULossFC",
                 "FocalLossConv",
                 "IOULossConv",
        ]

        FocalLossFC:
          name: "cls_fc"
          alpha: 0.75
          gamma: 2.0
          weight: 1.4  # 2 * 0.7
        IOULossFC:
          name: "reg_fc"
          weight: 0.6  # 2 * (1 - 0.7)
        FocalLossConv:
          name: "cls_conv"
          alpha: 0.75
          gamma: 2.0
          weight: 0.5  # 2.5 * (1 - 0.8)
        IOULossConv:
          name: "reg_conv"
          weight: 2.0  # 2.5 * 0.8

      task_head:
        name: "DoubleConvFCBBoxHead"
        DenseboxHead:
          total_stride: 8
          score_size: 19
          x_size: 289
          num_conv3x3: 2
          head_conv_bn: [False, False]
        DoubleConvFCBBoxHead:
          in_channels: 384  # MID_CHANNELS * 2  128
          num_convs: 7
          x_size: &TRAIN_X_SIZE 289
          score_size: 19
          total_stride: &TOTAL_STRIDE 16

        MyDenseboxHead:
          total_stride: 16
          score_size: 19
          x_size: 289
          num_conv3x3: 2
          head_conv_bn: [ False, False ]


    pipeline:
      name: "SiamFCppTracker"
      SiamFCppTracker:
        test_lr: 0.95
        window_influence: 0.21
        penalty_k: 0.04
        num_conv3x3: 3
        z_size: 127
        x_size: 289
        score_size: 19
        to_rgb: True
        normalize: True

      EFTracker:
        test_lr: 0.95
        window_influence: 0.21
        penalty_k: 0.04
        total_stride: 16
        score_size: 19
        z_size: 127
        x_size: 289
        normalize: True
        norm_mean: [ 123.675, 116.28, 103.53 ]
        norm_std: [ 58.395, 57.12, 57.375 ]
        to_rgb: True
    tester:
      names: ["UAVTrack112lTester",]
      GOT10kTester:
        data_root: "/home/yinyuxiao/testdate/got"
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        subsets: ["test"]  # (val|test)
      DTB70Tester:
        data_root: "/media/yinyuxiao/Data/my_code/testing_datasets/DTB70"
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        device_num: 1
        subsets: [ "DTB70" ]
      UAVTester:
        data_root: "/media/yinyuxiao/Data/my_code/testing_datasets/UAV123"
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        device_num: 1
        subsets: [ "UAV20L" ]  # UAV20L UAV123
      OTBTester:
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        device_num: 1
        subsets: [ "otb2015" ]
      UAV10fpsTester:
        data_root: "/media/yinyuxiao/Data/my_code/testing_datasets/UAV123_10fps"
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        device_num: 1
        subsets: [ "UAV123_10FPS" ]  # UAV20L UAV123   UAV123_10fps
      UAVTrack112lTester:
        data_root: "/media/yinyuxiao/Data/my_code/testing_datasets/UAVTrack112_l"
        exp_name: *TEST_NAME
        exp_save: *TEST_SAVE
        device_num: 1
        subsets: [ "UAVTRACK112_L" ]  # UAV20L UAV123   UAV123_10fps

      VOTTester:
        device_num: 1